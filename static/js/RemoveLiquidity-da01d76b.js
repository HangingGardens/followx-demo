import{a6 as Ne,a7 as b,a8 as we,a9 as F,aa as U,ab as le,_ as H,d as D,I as He,D as W,z as Z,T as I,Q as E,V as de,S,R as xe,ac as De,i as P,o as w,c as k,b as a,E as K,H as X,e as y,ad as ie,u as n,j as oe,y as c,ae as Oe,A as z,Y as Me,p as fe,l as be,af as ze,r as re,Z as Ke,$ as je,w as N,g as Y,n as se,F as G,h as We,m as J,J as Ze,P as ne,ag as Je,B as v,k as Q,O as Qe,N as Xe,W as Ye,X as Ge}from"./index-1a894d4d.js";import{t as R}from"./toast-c9703a34.js";import{T as ee}from"./TokenImage-0f6039fb.js";const et=""+new URL("../images/setting-66f9da98.svg",import.meta.url).href,tt=""+new URL("../images/copy-8d712cf3.svg",import.meta.url).href,ve=()=>{const o=Ne();return{getAmountsOut:async(u,t)=>{try{const e=await o.getAmountsOut(b(u),t);return we(e[e.length-1]).toString()}catch{return 0}},getAmountsIn:async(u,t)=>{try{const e=await o.getAmountsIn(b(u),t);return we(e[0]).toString()}catch{return 0}},swapExactTokensForTokens:async(u,t,e,i,s)=>{console.log("amountIn:"+u),console.log("toweiamountIn:"+b(u)),console.log("amountOutMin:"+t),console.log("amountOutMin:"+b(t.toString())),console.log("path:"+e),console.log("to:"+i),console.log("deadline:"+Date.now()+1e3*60*s);try{const d=await o.swapExactTokensForTokens(b(u),b(t.toString()),e,i,Date.now()+6e4*s);return F(d)}catch(d){return R(d),U(d)}},swapExactETHForTokens:async(u,t,e,i,s)=>{try{const d=await o.swapExactETHForTokens(b(t),e,i,Date.now()+6e4*s,{value:le(u.toString())._hex});return F(d)}catch(d){return R(d),U(d)}},swapExactTokensForETH:async(u,t,e,i,s)=>{try{const d=await o.swapExactTokensForTokens(b(u),b(t),e,i,Date.now()+6e4*s);return F(d)}catch(d){return R(d),U(d)}},swapTokensForExactTokens:async(u,t,e,i,s)=>{try{const d=await o.swapTokensForExactTokens(b(u),b(t),e,i,Date.now()+6e4*s);return F(d)}catch(d){return R(d),U(d)}},swapETHForExactTokens:async(u,t,e,i,s)=>{try{const d=await o.swapExactETHForTokens(b(u),e,i,Date.now()+6e4*s,{value:le(t.toString())._hex});return F(d)}catch(d){return R(d),U(d)}},swapTokensForExactETH:async(u,t,e,i,s)=>{console.log(u);try{const d=await o.swapTokensForExactTokens(b(u),b(t),e,i,Date.now()+6e4*s);return F(d)}catch(d){return R(d),U(d)}},addLiquidity:async(u,t,e,i,s,d,L,h)=>{console.log(u,t,e,i,s,d,L,h),console.log(Date.now()+1e3*60*h);try{const j=await(await o.addLiquidity(u,t,b(e),b(i),b(s),b(d),L,Date.now()+6e4*h)).wait();return F(j)}catch(j){return console.log(j),R(j),U(j)}},addLiquidityETH:async(u,t,e,i,s,d,L)=>{try{const h=await(await o.addLiquidityETH(t,b(e),b(i),b(s),d,Date.now()+6e4*L,{value:le(u.toString())._hex})).wait();return F(h)}catch(h){return console.log(h),R(h),U(h)}},removeLiquidity:async(u,t,e,i,s,d,L)=>{console.log(u,t,e,i,s,d,L),console.log(Date.now()+1e3*60*L);try{const h=await(await o.removeLiquidity(u,t,b(e),b(i),b(s),d,Date.now()+6e4*L)).wait();return F(h)}catch(h){return R(h),U(h)}},removeLiquidityETH:async(u,t,e,i,s,d)=>{try{const L=await(await o.removeLiquidityETH(u,b(t),b(e),b(i),s,Date.now()+6e4*d)).wait();return F(L)}catch(L){return R(L),U(L)}}}};const ye=o=>(fe("data-v-2b1458e6"),o=o(),be(),o),nt={class:"bg-box rounded-xl py-1.5 px-2 flex-center"},ot={key:1,class:"flex-1"},st={class:"font-bold text-baseColor"},at=ye(()=>a("img",{src:tt,class:"w-6 h-auto"},null,-1)),lt=[at],it={class:"mt-1 text-xs font-medium flex-center-bw"},rt=ye(()=>a("div",null,null,-1)),dt=D({props:{token:{type:null,required:!0},modelValue:{type:[String,Number,null],required:!0},disabled:{type:Boolean,required:!0},loading:{type:Boolean,required:!0}},emits:["update:modelValue","focus","blur","handleSelectToken"],setup(o,{emit:p}){const{token:g,modelValue:A,disabled:C,loading:$}=o;He(async()=>{u()},3e3,{immediate:!0}),ve();const[l,V]=W(!0),T=Z({symbol:"-",balance:null,price:null}),_=ze(e=>{p("update:modelValue",e)},500,{maxWait:5e3}),f=()=>{p("focus"),p("update:modelValue",T.balance)},x=e=>{_(e)},B=async()=>{T.symbol=await S(g.address).symbol()},u=async()=>{if(I(g.address,E.BNB)){T.balance=await de();return}T.balance=(await S(g.address).balanceOf()).toString()},t=async()=>{B(),u(),T.price=await Me(g.address)};return xe(g,(e,i)=>{V(!1),De(()=>{V(!0)}),t()},{deep:!0,immediate:!0}),(e,i)=>{const s=P("VanField"),d=P("van-loading"),L=P("van-icon");return w(),k("div",null,[a("div",nt,[o.loading?(w(),k("div",ot,[y(d,{size:"16"})])):(w(),K(s,{key:0,modelValue:o.modelValue,"onUpdate:modelValue":[i[0]||(i[0]=h=>X(A)?A.value=h:null),x],class:"flex-1 text-xs font-bold bg-box rounded-xl text-baseColor",placeholder:"0",disabled:o.disabled,onFocus:i[1]||(i[1]=h=>p("focus")),onBlur:i[2]||(i[2]=h=>p("blur"))},null,8,["modelValue","disabled"])),a("div",{class:"dark:bg-[#061629] bg-box px-4 py-3.5 flex-center gap-2 rounded-xl cursor-pointer",onClick:i[4]||(i[4]=ie(h=>p("handleSelectToken"),["stop"]))},[n(l)?(w(),K(ee,{key:0,src:o.token.logoURI,class:"w-5 h-5",size:20},null,8,["src"])):oe("v-if",!0),a("div",st,c(n(T).symbol),1),y(L,{name:"arrow-down",alt:"",class:"w-2.5 h-auto text-main"}),a("div",{onClick:i[3]||(i[3]=ie(h=>n(Oe)(o.token.address),["stop"]))},lt)])]),a("div",it,[rt,a("div",{class:"text-[#46598B] cursor-pointer text-right",onClick:f},c(e.$t("swap.balance"))+" "+c(n(z)(n(T).balance||0,8)),1)])])}}}),ge=H(dt,[["__scopeId","data-v-2b1458e6"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/trade/swap/SwapItem.vue"]]),ct={key:1},ut=D({props:{token:{type:null,required:!0}},setup(o){const{token:p}=o,g=re(null),A=re(!1),C=async()=>{if(!p.address)return;A.value=!0;const l=I(p.address,E.BNB)?await de():await S(p.address).balanceOf();A.value=!1,g.value=l},$=()=>{C()};return Ke(()=>{$()}),(l,V)=>{const T=P("VanLoading");return w(),k("div",null,[A.value?(w(),K(T,{key:0,size:"14"})):(w(),k("span",ct,c(n(z)(g.value||0,4)),1))])}}}),pt=H(ut,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/components/TokenBalance.vue"]]);const mt={class:"bg-white box-shadow rounded-2xl w-[320px] lg:w-[390px] text-black px-2.5 lg:px-5 h-[550px]"},wt={class:"h-[200px] pt-[30px]"},gt={class:"flex-center-bw h-10 font-bold text-2xl"},xt={class:"h-[50px] flex items-center bg-[#EAF4FF] rounded-[15px] mt-[15px] inset-shadow px-1"},ft={class:"grid grid-cols-4 gap-1 py-[15px] border-b border-solid border-[#E9E9E9]"},bt=["onClick"],vt={class:"h-[350px] overflow-y-scroll"},yt={key:0,class:"flex-center mt-4"},kt=["onClick"],ht={class:"flex-center"},_t={class:"flex flex-col ml-2.5"},At={class:"text-base"},$t={class:"text-[#46598B]"},Tt={class:"text-right"},Lt=D({props:{show:{type:Boolean,required:!0},tokenA:{type:String,required:!1},tokenB:{type:String,required:!1}},emits:["close","confirmSelectToken"],setup(o,{emit:p}){const{show:g,tokenA:A,tokenB:C}=o,$=je("importTokenList",[]),l=Z({tokenAddress:null,tokens:$.value.concat(E.tokens),resultToken:[],searchLoading:!1}),V=async()=>{if(l.resultToken=[],!l.tokenAddress)return;l.searchLoading=!0;const _=E.tokens.filter(x=>x.symbol.includes(l.tokenAddress));if(l.resultToken.push(..._),await S(l.tokenAddress).isErc20()){const x=E.tokens.find(B=>B.address===l.tokenAddress);if(x)l.resultToken.push(x);else{const B={name:await S(l.tokenAddress).name(),symbol:await S(l.tokenAddress).symbol(),address:l.tokenAddress};l.resultToken.push(B)}}l.searchLoading=!1},T=async(_,f)=>{if(f)return;const x={..._,logoURI:_.logoURI||""};l.tokens.findIndex(u=>u.address===_.address)===-1&&$.value.unshift(x),l.tokenAddress=null,p("confirmSelectToken",x),p("close")};return(_,f)=>{const x=P("van-icon"),B=P("van-field"),u=P("VanLoading"),t=P("VanPopup");return o.show?(w(),K(t,{key:0,show:o.show,"onUpdate:show":f[2]||(f[2]=e=>X(g)?g.value=e:null),class:"bg-transparent",rounded:"",onClickOverlay:f[3]||(f[3]=e=>p("close")),onClickCloseIcon:f[4]||(f[4]=e=>p("close"))},{default:N(()=>[a("div",mt,[a("div",wt,[a("div",gt,[a("div",null,c(_.$t("trade.token.select")),1),y(x,{name:"cross",onClick:f[0]||(f[0]=e=>p("close"))})]),a("div",xt,[y(B,{modelValue:n(l).tokenAddress,"onUpdate:modelValue":[f[1]||(f[1]=e=>n(l).tokenAddress=e),V],"right-icon":"search",placeholder:_.$t("trade.token.selectSearch")},{"right-icon":N(()=>[y(x,{name:"search",class:"text-[#29AAC7] text-2xl font-bold",onClick:V})]),_:1},8,["modelValue","placeholder"])]),a("div",ft,[(w(!0),k(G,null,Y(n(l).tokens.slice(0,4),e=>(w(),k("div",{class:se(["bg-[#EAF4FF] rounded-[15px] h-[34px] cursor-pointer flex-center text-sm",{"opacity-60":n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address)}]),onClick:i=>T(e,n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address))},[y(ee,{src:e.logoURI,class:"w-6 h-6 mr-1",size:24},null,8,["src"]),a("span",null,c(e.symbol),1)],10,bt))),256))])]),oe(" scroll "),a("div",vt,[n(l).searchLoading?(w(),k("div",yt,[y(u,{size:"20"})])):(w(!0),k(G,{key:1},Y(n(l).tokenAddress?n(l).resultToken:n(l).tokens,e=>(w(),k("div",{class:se(["h-[45px] flex-center-bw mt-[15px] cursor-pointer",{"opacity-60":n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address)}]),onClick:i=>T(e,n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address))},[a("div",ht,[y(ee,{src:e.logoURI,class:"w-6 h-6",size:24},null,8,["src"]),a("div",_t,[a("div",At,c(e.symbol),1),a("div",$t,c(e.name),1)])]),a("div",Tt,[y(pt,{token:e},null,8,["token"])])],10,kt))),256))])])]),_:1},8,["show"])):oe("v-if",!0)}}}),Bt=H(Lt,[["__scopeId","data-v-325f02e4"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/components/SelectTokenPop.vue"]]);const St=o=>(fe("data-v-27a4fc01"),o=o(),be(),o),Ct={class:"bg-white px-4 py-7 w-[320px] text-[#646464]"},Et={class:"grid grid-cols-4 gap-x-2 mt-4 pb-6 text-[#29AAC7] border-b border-solid border-[#E9E9E9]"},Vt=["onClick"],It={class:"flex-center"},qt=J(" % "),Pt={class:"flex-center-bw gap-5 mt-4"},Ft={class:"whitespace-nowrap"},Ut={class:"flex-center text-[#29AAC7] gap-1"},Rt=St(()=>a("div",null,"mins",-1)),Nt={class:"flex-center-bw mt-5"},Ht={class:"text-[#646464]"},Dt=["src"],Ot=D({props:{show:{type:Boolean,required:!0},slipValue:{type:[String,Number,null],required:!0},timeValue:{type:[String,Number,null],required:!0},modeValue:{type:[Boolean,null],required:!1}},emits:["close","update:slip-value","update:time-value","changeMode"],setup(o,{emit:p}){const{show:g,slipValue:A,modeValue:C}=o,$=[.1,.5,1],l=re(10),V=f=>{p("update:slip-value",+f>=50?50:f)},T=f=>{p("changeMode",!f)},_=()=>{p("close"),p("update:time-value",l.value)};return(f,x)=>{const B=P("VanField"),u=P("VanPopup");return w(),K(u,{show:o.show,"onUpdate:show":x[3]||(x[3]=t=>X(g)?g.value=t:null),class:"bg-transparent",closeable:"",round:"",onClickOverlay:x[4]||(x[4]=t=>p("close")),onClickCloseIcon:_},{default:N(()=>[a("div",Ct,[a("div",null,c(f.$t("swap.slippageTolerance")),1),a("div",Et,[(w(),k(G,null,Y($,t=>a("div",{class:"cursor-pointer rounded-xl border border-solid border-[#29AAC7] flex-center",onClick:e=>V(String(t))},c(t)+" % ",9,Vt)),64)),a("div",It,[y(B,{modelValue:o.slipValue,"onUpdate:modelValue":[x[0]||(x[0]=t=>X(A)?A.value=t:null),V],"input-align":"center",class:"flex-1 border border-solid border-[#29AAC7] rounded-xl text-xs text-[#29AAC7] font-bold px-0",type:"number"},null,8,["modelValue"]),qt])]),a("div",Pt,[a("div",Ft,c(f.$t("swap.Txdeadline")),1),a("div",Ut,[y(B,{modelValue:l.value,"onUpdate:modelValue":x[1]||(x[1]=t=>l.value=t),class:"flex-1 border border-solid border-[#29AAC7] rounded-xl text-xs text-baseColor font-bold",type:"number","input-align":"center"},null,8,["modelValue"]),Rt])]),a("div",Nt,[a("div",Ht,c(f.$t("swap.expertMode")),1),a("div",{onClick:x[2]||(x[2]=ie(t=>T(o.modeValue),["stop"])),class:"cursor-pointer"},[a("img",{src:n(We)(`${o.modeValue?"switch-active":"switch"}.svg`),class:"w-16 h-auto"},null,8,Dt)])])])]),_:1},8,["show"])}}}),Mt=H(Ot,[["__scopeId","data-v-27a4fc01"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/trade/swap/SettingPop.vue"]]),zt={class:"flex items-center gap-8 p-2.5"},Kt=["onClick"],jt=D({props:{currentTab:{type:null,required:!0}},emits:["change"],setup(o,{emit:p}){const{t:g}=Ze(),A=ne(()=>[{id:0,name:g("liquidity.add")},{id:1,name:g("liquidity.yours")}]);return(C,$)=>(w(),k("div",zt,[(w(!0),k(G,null,Y(n(A),l=>(w(),k("div",{key:l.id,class:se(["cursor-pointer font-semibold rounded-lg py-1",{"text-main":l.id===o.currentTab}]),onClick:V=>p("change",l.id)},c(l.name),11,Kt))),128))]))}}),Wt=H(jt,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/LiquidityTab.vue"]]),Zt=""+new URL("../images/add-da02e148.svg",import.meta.url).href,Jt={class:"flex-center gap-x-4 mt-4"},Qt=["onClick"],Xt=D({props:{percentList:{type:Array,required:!0},percent:{type:Number,required:!0}},emits:["change"],setup(o,{emit:p}){return(g,A)=>(w(),k("div",Jt,[(w(!0),k(G,null,Y(o.percentList,C=>(w(),k("div",{key:C,onClick:$=>p("change",C),class:se(["py-[3px] px-[18px] rounded-xl border border-solid border-[#081e37] cursor-pointer",{"bg-config-sub text-origin":C===o.percent}])},c(C*100)+"% ",11,Qt))),128))]))}}),Yt=H(Xt,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/PercentBox.vue"]]),Gt={class:"flex-center-bw mb-[38px]"},en={class:"text-[32px] font-bold"},tn=a("img",{src:et,class:"w-[27px] h-[27px]",alt:""},null,-1),nn=[tn],on=D({emits:["open"],setup(o,{emit:p}){return(g,A)=>(w(),k("div",Gt,[a("div",en,[Je(g.$slots,"default")]),a("div",{class:"cursor-pointer",onClick:A[0]||(A[0]=C=>p("open"))},nn)]))}}),sn=H(on,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/SettingTitle.vue"]]),an={class:"bg-white box-shadow rounded-2xl w-[320px] lg:w-[500px] text-black px-5 py-7"},ln={class:"flex-center-bw h-10 font-bold text-2xl"},rn={class:"text-[#29AAC7] mt-[15px]"},dn={class:"bg-[#E8F0F9] rounded-lg px-5 py-3 mt-[15px]"},cn={class:"flex-center-bw"},un={class:"flex items-center gap-2.5"},pn={class:"flex items-center"},mn={class:"lg:text-2xl text-sm font-bold"},wn={class:"lg:text-2xl text-sm font-bold"},gn={class:"text-right font-bold text-[#29AAC7] lg:text-lg mt-3.5"},xn={class:"flex-center-bw mt-3"},fn={class:"text-[#646464]"},bn={class:"text-right text-[#29AAC7]"},vn={class:"flex-center-bw mt-3"},yn={class:"text-[#646464]"},kn={class:"text-right text-[#29AAC7]"},hn=a("div",{class:"w-full h-[1px] bg-[#E9E9E9] my-[15px]"},null,-1),_n={class:"border border-solid border-config-sub rounded-[10px] p-2.5"},An={class:"text-config-sub"},$n={class:"text-right mt-3"},Tn={class:"text-right"},Ln=D({props:{show:{type:Boolean,required:!0},pair:{type:null,required:!0},tokenA:{type:null,required:!0},tokenB:{type:null,required:!0},slip:{type:null,required:!0},aPercent:{type:null,required:!0},bPercent:{type:null,required:!0},shares:{type:null,required:!0},expectedLp:{type:null,required:!0}},emits:["close","confirmAdd"],setup(o,{emit:p}){const{show:g,slip:A,shares:C}=o;return($,l)=>{const V=P("van-icon"),T=P("VanPopup");return w(),K(T,{show:o.show,"onUpdate:show":l[2]||(l[2]=_=>X(g)?g.value=_:null),class:"bg-transparent",rounded:"",onClickOverlay:l[3]||(l[3]=_=>p("close")),onClickCloseIcon:l[4]||(l[4]=_=>p("close"))},{default:N(()=>[a("div",an,[a("div",ln,[a("div",null,c($.$t("liquidity.confirmAdd")),1),y(V,{name:"cross",onClick:l[0]||(l[0]=_=>p("close"))})]),a("div",rn,c($.$t("liquidity.willRecieve")),1),a("div",dn,[a("div",cn,[a("div",un,[a("div",pn,[y(ee,{src:o.tokenA.logoURI,class:"-mr-2 w-6 h-6",size:24},null,8,["src"]),y(ee,{src:o.tokenB.logoURI,class:"w-6 h-6",size:24},null,8,["src"])]),a("div",mn,c(o.tokenA.symbol)+"-"+c(o.tokenB.symbol)+" LP",1)]),a("div",wn,c(o.pair?n(z)(o.expectedLp,9):""),1)]),a("div",gn,c(n(z)(o.tokenA.amount))+c(o.tokenA.symbol)+"/ "+c(n(z)(o.tokenB.amount))+c(o.tokenB.symbol),1)]),a("div",xn,[a("div",fn,c($.$t("liquidity.shareInLp")),1),a("div",bn,c(o.pair?n(z)(o.shares,9):"100")+" %",1)]),a("div",vn,[a("div",yn,c($.$t("trade.token.slippageLimit")),1),a("div",kn,c(o.slip)+"%",1)]),hn,a("div",_n,[a("div",An,c($.$t("trade.token.rate")),1),a("div",$n," 1 "+c(o.tokenA.symbol)+" = "+c(o.pair?n(z)(new n(v)(o.aPercent).div(o.bPercent).toString(),9):new n(v)(o.tokenA.amount).dividedBy(o.tokenB.amount).toString())+" "+c(o.tokenB.symbol),1),a("div",Tn," 1 "+c(o.tokenB.symbol)+" = "+c(o.pair?n(z)(new n(v)(o.bPercent).div(o.aPercent).toString(),9):new n(v)(o.tokenB.amount).dividedBy(o.tokenA.amount).toString())+" "+c(o.tokenA.symbol),1)]),y(Q,{class:"mt-[15px]",loading:!1,disabled:!1,onClick:l[1]||(l[1]=_=>p("confirmAdd"))},{default:N(()=>[J(c($.$t("liquidity.confirmAdd")),1)]),_:1})])]),_:1},8,["show"])}}}),Bn=H(Ln,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/ConfirmAddPop.vue"]]),Sn={class:"lg:px-8 px-2.5 py-5"},Cn=a("div",{class:"flex-center py-8"},[a("img",{src:Zt,class:"w-6 h-6",alt:""})],-1),En={key:1,class:"grid grid-cols-2 gap-1 mt-7"},Vn={key:0},In={key:1},qn={key:2},Pn={key:3},Fn=D({setup(o){const[p,g]=W(!1),[A,C]=W(!1),[$,l]=W(!1),{getPair:V}=Qe(),{addLiquidity:T,addLiquidityETH:_}=ve(),{getCurrentAccount:f}=Xe(),x=ne(()=>t.allowance>=+t.amount&&t.allowance>0),B=ne(()=>e.allowance>=+e.amount&&e.allowance>0),u=[.25,.5,.75,1],t=Z({...E.tokens[0],balance:0,allowance:0,decimals:18,amount:null,percent:0}),e=Z({...E.tokens[1],balance:0,allowance:0,decimals:18,amount:null,percent:0}),i=Z({slip:.1,time:10,min:"0",mode:!1}),s=Z({settingShow:!1,btnLoading:!1,havePair:!1,aPercent:"0",bPercent:"0",aDisabled:!1,bDisabled:!1,aInputLoading:!1,bInputLoading:!1,pair:null,txInfo:{tx:null,text:""},tokenSelectIndex:0,shares:"0",totalSupply:"0",aInLpAmount:"0",bInLpAmount:"0"}),d=ne(()=>{if(s.pair){const r=new v(t.amount).multipliedBy(s.totalSupply).div(s.aInLpAmount).toFixed(),m=new v(e.amount).multipliedBy(s.totalSupply).div(s.bInLpAmount).toFixed();return Math.min(+r,+m)}else return console.log(new v(t.amount).multipliedBy(e.amount).minus(1e3).toFixed()),new v(t.amount).multipliedBy(e.amount).minus(1e3)}),L=r=>{t.amount=null,e.amount=null,s.tokenSelectIndex=r,C(!0)},h=r=>{s.btnLoading||(t.percent=r,ce(new v(t.balance).multipliedBy(r).toString()),s.havePair&&(e.percent=0))},j=r=>{i.slip=r},ke=r=>{i.time=r},he=r=>{i.mode=r},_e=()=>{s.bDisabled=!0,s.aDisabled=!1},Ae=()=>{s.aDisabled=!0,s.bDisabled=!1},ce=async r=>{if(t.amount=r,console.log(s.havePair),!!s.havePair){if(r===""){t.amount=null,e.amount=null,s.bInputLoading=!1;return}s.bInputLoading=!0,e.amount=new v(t.amount).times(new v(s.bPercent)).dividedBy(new v(s.aPercent)).toFixed(),s.bInputLoading=!1}},$e=async r=>{if(e.amount=r,!!s.havePair){if(r===""){t.amount=null,e.amount=null,s.aInputLoading=!1;return}s.aInputLoading=!0,t.amount=new v(e.amount).times(new v(s.aPercent)).dividedBy(new v(s.bPercent)).toFixed(),s.aInputLoading=!1}},Te=async()=>{s.btnLoading=!0,x.value?await S(e.address).approve(E.PANCAKE_ROUTER):await S(t.address).approve(E.PANCAKE_ROUTER),await te(),s.btnLoading=!1},[Le,ue]=W(!1),Be=async()=>{ue(!0),await S(t.address).approve(E.PANCAKE_ROUTER),await te(),ue(!1)},[Se,pe]=W(!1),Ce=async()=>{pe(!0),await S(e.address).approve(E.PANCAKE_ROUTER),await te(),pe(!1)},Ee=async()=>{if(!x.value||!B.value)return Te();g(!0)},Ve=async()=>{g(!1),s.btnLoading=!0;let r;const m=I(t.address,E.BNB),q=I(e.address,E.BNB);if(t.amountTokenMin=new v(t.amount).times(1e4-100*i.slip).div(1e4).toFixed(t.decimals||18),e.amountTokenMin=new v(e.amount).times(1e4-100*i.slip).div(1e4).toFixed(e.decimals||18),m||q){const O=m?t:e,M=m?e:t;console.log(O),console.log(M),r=await _(new v(O.amount).toFixed(O.decimals),M.address,new v(M.amount).toFixed(M.decimals),M.amountTokenMin,O.amountTokenMin,f(),i.time)}else r=await T(t.address,e.address,new v(t.amount).toFixed(t.decimals),new v(e.amount).toFixed(e.decimals),t.amountTokenMin,e.amountTokenMin,f(),i.time);if(s.btnLoading=!1,!r.success)return g(!0);await ae()},me=async r=>{const{balanceOf:m,allowance:q,symbol:O,decimals:M}=S(r),Pe=I(r,E.BNB)?await de():await m(),Fe=I(r,E.BNB)?Ye:await q(E.PANCAKE_ROUTER),Ue=await O(),Re=await M();return{balance:Pe,allowance:+Fe,symbol:Ue,decimals:Re}},te=async()=>{const r=await me(t.address),m=await me(e.address);t.balance=r.balance,t.allowance=r.allowance,t.symbol=r.symbol,t.decimals=r.decimals,e.balance=m.balance,e.allowance=m.allowance,e.symbol=m.symbol,e.decimals=m.decimals},Ie=async()=>{const r=await V(t.address,e.address);if(s.pair=r,r===Ge)return s.pair=null,!1;const m=await S(t.address).balanceOf(s.pair),q=await S(e.address).balanceOf(s.pair),O=new v(m).plus(new v(q));s.aPercent=new v(m).dividedBy(O).multipliedBy(100).toString(),s.bPercent=new v(q).dividedBy(O).multipliedBy(100).toString();const M=await S(r).balanceOf();return s.totalSupply=await S(r).totalSupply(),s.shares=new v(M).div(s.totalSupply).multipliedBy(100).toFixed(),s.aInLpAmount=String(await S(t.address).balanceOf(r)),s.bInLpAmount=String(await S(e.address).balanceOf(r)),!0},qe=r=>{if(s.tokenSelectIndex===0)for(let m in r)t[m]=r[m];else for(let m in r)e[m]=r[m];ae()},ae=async()=>{s.btnLoading=!0,await te(),s.havePair=await Ie(),s.btnLoading=!1};return xe(()=>[t,e],async()=>{ae()},{immediate:!0}),(r,m)=>(w(),k("div",Sn,[y(sn,{onOpen:m[0]||(m[0]=q=>n(l)(!0))},{default:N(()=>[J(c(r.$t("liquidity.add")),1)]),_:1}),y(ge,{token:n(t),modelValue:n(t).amount,"onUpdate:modelValue":ce,onFocus:_e,disabled:n(s).btnLoading,onHandleSelectToken:m[1]||(m[1]=q=>L(0)),loading:n(s).aInputLoading},null,8,["token","modelValue","disabled","loading"]),y(Yt,{percentList:u,onChange:h,percent:n(t).percent},null,8,["percent"]),Cn,y(ge,{token:n(e),modelValue:n(e).amount,"onUpdate:modelValue":$e,onFocus:Ae,disabled:n(s).btnLoading,loading:n(s).bInputLoading,onHandleSelectToken:m[2]||(m[2]=q=>L(1))},null,8,["token","modelValue","disabled","loading"]),oe(' <PercentBox :percentList="percentList" @change="changeAmountB" :percent="tokenB.percent" /> '),+n(t).amount>+n(t).balance||n(t).balance<=0||+n(e).amount>+n(e).balance||+n(e).balance<=0?(w(),K(Q,{key:0,class:"mt-7",disabled:""},{default:N(()=>[J(c(r.$t("errorMsg.InsufficientBalance")),1)]),_:1})):!n(x)||!n(B)?(w(),k("div",En,[y(Q,{loading:n(Le),disabled:n(x),onClick:Be},{default:N(()=>[J(" Approve "+c(n(t).symbol),1)]),_:1},8,["loading","disabled"]),y(Q,{loading:n(Se),disabled:n(B),onClick:Ce},{default:N(()=>[J(" Approve "+c(n(e).symbol),1)]),_:1},8,["loading","disabled"])])):(w(),K(Q,{key:2,class:"mt-7",loading:n(s).btnLoading,onClick:Ee,disabled:+n(t).amount<=0||+n(e).amount<=0},{default:N(()=>[+n(t).amount>+n(t).balance||n(t).balance<=0?(w(),k("span",Vn,c(r.$t("errorMsg.InsufficientBalance")),1)):n(x)?n(B)?(w(),k("span",Pn,c(r.$t("trade.addLiquid")),1)):(w(),k("span",qn,"Approve "+c(n(e).symbol),1)):(w(),k("span",In,"Approve "+c(n(t).symbol),1))]),_:1},8,["loading","disabled"])),y(Bt,{tokenA:n(t).address,tokenB:n(e).address,show:n(A),onClose:m[3]||(m[3]=q=>n(C)(!1)),onConfirmSelectToken:qe},null,8,["tokenA","tokenB","show"]),y(Mt,{show:n($),onClose:m[4]||(m[4]=q=>n(l)(!1)),timeValue:n(i).time,slipValue:n(i).slip,modeValue:n(i).mode,"onUpdate:slipValue":j,"onUpdate:timeValue":ke,onChangeMode:he},null,8,["show","timeValue","slipValue","modeValue"]),y(Bn,{pair:n(s).pair,show:n(p),onClose:m[5]||(m[5]=q=>n(g)(!1)),onConfirmAdd:Ve,removeAmount:0,tokenA:n(t),tokenB:n(e),slip:n(i).slip,aPercent:n(s).aPercent,bPercent:n(s).bPercent,shares:n(s).shares,expectedLp:n(d)},null,8,["pair","show","tokenA","tokenB","slip","aPercent","bPercent","shares","expectedLp"])]))}}),Un=H(Fn,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/Add.vue"]]),Rn={class:"max-w-[600px] relative"},Nn=D({setup(o){return(p,g)=>(w(),k("div",Rn,[y(Wt,{"current-tab":1}),y(Un)]))}}),Hn=H(Nn,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/RemoveLiquidity.vue"]]),zn=Object.freeze(Object.defineProperty({__proto__:null,default:Hn},Symbol.toStringTag,{value:"Module"}));export{Wt as L,Yt as P,Un as R,ge as S,et as _,Mt as a,Bt as b,Zt as c,sn as d,Hn as e,zn as f,ve as r};
