import{al as V,a5 as d,a4 as g,ac as O,N,_ as L,d as P,o as p,c as k,u as l,y as w,j as S,F as j,z as J,h as I,g as z,b as y,af as X,m as Z,ak as K,r as Q,R as Y,Z as tt,i as et,e as $,a6 as H,am as f,an as nt,A as ot,ao as st,S as b,G as T,B as rt}from"./index-7eb7ee78.js";import{t as C}from"./toast-2da6f72a.js";const at=()=>{const t=V();return{tokenCount:async()=>{try{const r=await t.tokenCount();return d(r)}catch(r){return g(r)}},getTokenRange:async(r,a)=>{try{const o=await t.getTokenRange(r,a);return d(o)}catch(o){return g(o)}},donationTokens:async r=>{try{const a=await t.donationTokens(r);return d(a)}catch(a){return g(a)}},donate:async(r,a)=>{try{const o=await(await t.donate(r,O(a))).wait();return d(o)}catch(o){return C(o),g(o)}},withdraw:async r=>{try{const a=await(await t.withdraw(r)).wait();return d(a)}catch(a){return console.log(a),C(a),g(a)}},extractInfos:async r=>{try{const a=await t.extractInfos(r,N().getCurrentAccount());return d(a)}catch(a){return g(a)}}}};var h=(t=>(t[t.PUBLIC=0]="PUBLIC",t[t.WHITELIST=1]="WHITELIST",t[t.UPCOMING=2]="UPCOMING",t[t.CLOSED=3]="CLOSED",t))(h||{}),E=(t=>(t[t.FIXED=0]="FIXED",t[t.WHITELIST=1]="WHITELIST",t))(E||{});const ct={key:0,class:"text-xs px-2 py-[2px] public"},it={key:1,class:"text-xs px-2 py-[2px] white-list"},lt={key:2,class:"text-xs px-2 py-[2px] upcoming"},ut={key:3,class:"text-xs px-2 py-[2px] closed"},mt=P({props:{status:{type:null,required:!0}},setup(t){return(n,e)=>(p(),k(j,null,[t.status===l(h).PUBLIC?(p(),k("div",ct,w(n.$t("ido.PUBLIC")),1)):t.status===l(h).WHITELIST?(p(),k("div",it,w(n.$t("ido.WHITELIST")),1)):t.status===l(h).UPCOMING?(p(),k("div",lt,w(n.$t("ido.UPCOMING")),1)):S("v-if",!0),t.status===l(h).CLOSED?(p(),k("div",ut,w(n.$t("ido.CLOSED")),1)):S("v-if",!0)],64))}}),dt=L(mt,[["__scopeId","data-v-74ab17ea"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/ido/components/StatusTag.vue"]]),gt=""+new URL("../images/download-20baf9d2.svg",import.meta.url).href,yt=["href"],xt=["src"],pt=["href"],kt=y("img",{src:gt,class:"w-6 h-6"},null,-1),wt=Z(" Whitepaper "),ft=[kt,wt],ht=P({props:{info:{type:null,required:!0}},setup(t){const n=J([{name:"twitter",icon:I("ido/twitter.svg"),url:""},{name:"telegram",icon:I("ido/telegram.svg"),url:""},{name:"medium",icon:I("ido/mingcute.svg"),url:""},{name:"discord",icon:I("ido/discord.svg"),url:""},{name:"website",icon:I("ido/earth.svg"),url:""}]);return(e,u)=>(p(),k("div",{class:"flex items-center gap-2",onClick:u[0]||(u[0]=X(()=>{},["stop"]))},[(p(!0),k(j,null,z(l(n),c=>(p(),k("div",{key:c.name},[t.info[c.name]?(p(),k("a",{key:0,href:t.info[c.name],target:"_blank"},[y("img",{src:c.icon,class:"w-8 h-8",alt:""},null,8,xt)],8,yt)):S("v-if",!0)]))),128)),t.info.whitepaper?(p(),k("a",{key:0,class:"border border-solid border-main rounded-md px-1 py-1 flex-center text-main text-xs",target:"_blank",href:t.info.whitepaper},ft,8,pt)):S("v-if",!0)]))}}),It=L(ht,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/ido/components/LinkList.vue"]]),Tt=(t,n)=>{const{currentLocale:e}=K(),u=Q({title:"",address:"",symbol:"",logoURI:"",introduce:"",twitter:"",telegram:"",medium:"",discord:"",website:"",whitepaper:"",rise:""}),c=async()=>{u.value=await fetch(`https://followx-img.s3.ap-southeast-1.amazonaws.com/${t===0?"swap":"whiteList"}-${n}-${e.value}.json`).then(x=>x.json())};return Y(e,async()=>{await c()}),tt(()=>{c()}),{jsonInfo:u}},_t={class:"flex-center-bw"},vt={class:"flex items-center gap-3"},St={class:"text-[28px] lg:text-[32px] font-black max-w-[150px] lg:max-w-[80%] truncate"},bt=["innerHTML"],Ct=P({props:{tokenInfo:{type:null,required:!0},tokenId:{type:[Number,String],required:!0},type:{type:Number,required:!0}},setup(t){const n=t,{jsonInfo:e}=Tt(n.type,n.tokenId);return(u,c)=>{var i,r,a,o;const x=et("VanImage");return p(),k("div",null,[y("div",_t,[y("div",vt,[$(x,{class:"w-[50px] h-[50px]",round:"",src:((i=l(e))==null?void 0:i.logoURI)||l(I)(`tokens/${(r=l(e))==null?void 0:r.symbol}.svg`),alt:""},null,8,["src"]),y("div",St,w((a=l(e))==null?void 0:a.title),1)]),$(dt,{status:t.tokenInfo.status},null,8,["status"])]),y("div",{class:"mt-8",innerHTML:(o=l(e))==null?void 0:o.introduce},null,8,bt),$(It,{class:"mt-4",info:l(e)},null,8,["info"])])}}}),Ut=L(Ct,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/ido/components/TokenInfo.vue"]]);const Lt={class:"mt-8"},Pt={class:"flex items-baseline justify-center"},$t={class:"text-main"},Nt={class:"text-2xl font-semibold"},Et={class:"bg-[#4a5987] p-1 rounded-xl mt-5"},Bt={class:"mt-2 text-lg font-bold text-center font-Mukta text-config-sub"},Ft=P({props:{tokenInfo:{type:null,required:!0}},setup(t){return(n,e)=>{var u,c,x,i;return p(),k("div",Lt,[y("div",Pt,[y("div",$t,[y("span",Nt,w(l(H)(l(f)(((u=t.tokenInfo.donatedAmount)==null?void 0:u.toString())||"0"))),1),y("span",null,w((c=t.tokenInfo)==null?void 0:c.paymentTokenSymbol),1)]),y("div",null," / "+w(l(H)(l(f)(((x=t.tokenInfo.targetAmount)==null?void 0:x.toString())||"0")))+" "+w((i=t.tokenInfo)==null?void 0:i.paymentTokenSymbol),1)]),y("div",Et,[y("div",{class:"h-3 max-w-full rounded-xl bg",style:nt({width:t.tokenInfo.progress*100>1?t.tokenInfo.progress*100+"%":0+"%"})},null,4)]),y("div",Bt,w(l(ot)(t.tokenInfo.progress*100,2))+"% "+w(n.$t("ido.raised")),1)])}}}),Mt=L(Ft,[["__scopeId","data-v-850c00f8"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/ido/components/IdoProgress.vue"]]),Rt=()=>{const t=st();return{tTokenCount:async()=>{try{const o=await t.tokenCount();return d(o)}catch(o){return g(o)}},tGetTokenRange:async(o,s)=>{try{const m=await t.getTokenRange(o,s);return d(m)}catch(m){return g(m)}},tokens:async o=>{try{const s=await t.tokens(o);return d(s)}catch(s){return g(s)}},buyTokens:async(o,s)=>{try{const m=await(await t.buyTokens(O(o),s)).wait();return d(m)}catch(m){return C(m),g(m)}},trades:async o=>{try{const s=N().getCurrentAccount(),m=await t.trades(o,s);return d(m)}catch(s){return g(s)}},extract:async o=>{try{const s=await(await t.extract(o)).wait();return d(s)}catch(s){return C(s),g(s)}},whitelists:async o=>{try{const s=await t.whitelists(o,N().getCurrentAccount());return d(s)}catch(s){return g(s)}},getByFlag:async o=>{try{const s=await t.getByFlag(o);return d(s)}catch(s){return g(s)}}}},Ht=async t=>{const n=[];for(let e=0;e<t.length;e++)n[e]=await At(t[e],String(e+1));return n},Ot=async t=>{const n=[];for(let e=0;e<t.length;e++)n[e]=await Wt(t[e],String(e+1));return n},At=async(t,n)=>{var _,B,F,R,A,W,D,G,U,M;const{extractInfos:e}=at(),u=q(t),c=await b(t.paymentToken).symbol(),x=await b(t.donationToken).symbol(),i=await e(n),r=f(((_=i.result.donationsNumber)==null?void 0:_.toString())||"0")/f(((B=t==null?void 0:t.donatedAmount)==null?void 0:B.toString())||"0");console.log({donateRatio:r});const a=f(((F=t.targetAmount)==null?void 0:F.toString())||"0")*r,o=Math.abs(f((R=i.result.donationsNumber)==null?void 0:R.toString())-a).toString(),s=f(((A=t.totalSupply)==null?void 0:A.toString())||"0")*r,m=s-f(((D=(W=i.result)==null?void 0:W.extractNumber)==null?void 0:D.toString())||"0"),v={tokenId:n,startTime:t.startTime,deadline:t.deadline,donationToken:t.donationToken,donationTokenSymbol:x,paymentToken:t.paymentToken,paymentTokenSymbol:c,targetAmount:t.targetAmount,donatedAmount:t.donatedAmount,tokenInfo:JSON.parse(t.remark||"{}"),extractionTime:i.result.extractTime,extractionTimes:i.result.extractTimes,extractTimes:t.extractTimes,minimumPurchase:t.minimumPurchase,status:u,progress:t.donatedAmount.toString()/t.targetAmount.toString(),type:E.FIXED,myDonatedAmount:i.result.donationsNumber,tokensPurchasedExtract:i.result.extractNumber,extractIntervalSeconds:t.extractIntervalSeconds,totalSupply:t.totalSupply,unExtracted:T(m),totalGet:T(s),totalFail:T(o),totalSuccess:T(a)};return console.log((G=t==null?void 0:t.donationsNumber)==null?void 0:G.toString()),console.log((U=t==null?void 0:t.totalSupply)==null?void 0:U.toString()),console.log((M=t==null?void 0:t.donatedAmount)==null?void 0:M.toString()),v},Wt=async(t,n)=>{var m,v,_;console.log(t);const{trades:e,getByFlag:u}=Rt(),c=q(t),x=await b(t.paymentToken).symbol(),i=await b(t.saleToken).symbol(),r=await e(n);let o=(await u(n)).result;const s={startTime:t.startTime,deadline:t.deadline,donationTokenSymbol:i,targetAmount:t.maxTokens,tokenId:n,tokenInfo:JSON.parse(t.remark||"{}"),status:c,progress:t.tokensSold.toString()/t.maxTokens.toString(),paymentTokenSymbol:x,donatedAmount:t.tokensSold,totalSupply:t.maxTokens,donationToken:t.saleToken,paymentToken:t.paymentToken,type:E.WHITELIST,inRule:o,minimumPurchase:new rt(0),myDonatedAmount:r.result.tokensPurchased,extractionTime:r.result.extractionTime,extractionTimes:r.result.extractionTimes,tokensPurchasedExtract:r.result.tokensPurchasedExtract,extractIntervalSeconds:t.rule.extractIntervalSeconds,extractTimes:t.rule.extractTimes,whitelistFlag:t.rule.whitelistFlag,tokenPrice:t.tokenPrice,maxTokensPerBuyer:t.maxTokensPerBuyer,totalGet:T(f(((m=r.result.tokensPurchased)==null?void 0:m.toString())||"0")),totalFail:0,unExtracted:T(+f(((v=r.result.tokensPurchased)==null?void 0:v.toString())||"0")-+f(((_=r.result.tokensPurchasedExtract)==null?void 0:_.toString())||"0"))};return console.log(s),s},q=t=>{const n=new Date().getTime()/1e3;let e=h.PUBLIC;return n>=t.deadline?e=h.CLOSED:n>t.startTime&&n<t.deadline?e=h.PUBLIC:n<t.startTime&&(e=h.UPCOMING),e};export{Mt as I,E as M,h as S,Ut as T,Ot as a,At as b,Wt as c,at as f,Ht as h,Rt as w};
