import{ab as Re,ac as b,ad as we,a5 as F,a4 as U,ae as le,_ as H,d as D,I as Ne,P as X,z as W,T as I,Q as S,V as de,S as L,R as ge,i as P,o as x,c as h,b as a,af as ie,e as y,y as d,u as n,ag as He,A as z,E as j,H as G,j as Y,ah as De,p as fe,l as ve,r as re,Z as Oe,$ as Me,w as N,g as ee,n as se,F as te,h as ze,m as Z,J as Ke,ai as je,B as k,k as Q,D as J,O as We,N as Ze,W as Je,X as Qe}from"./index-16f64607.js";import{T as ne,_ as Xe}from"./TokenImage-031f23f9.js";import{t as R}from"./toast-a75b7350.js";const Ge=""+new URL("../images/setting-66f9da98.svg",import.meta.url).href,be=()=>{const o=Re();return{getAmountsOut:async(p,t)=>{try{const e=await o.getAmountsOut(b(p),t);return we(e[e.length-1]).toString()}catch{return 0}},getAmountsIn:async(p,t)=>{try{const e=await o.getAmountsIn(b(p),t);return we(e[0]).toString()}catch{return 0}},swapExactTokensForTokens:async(p,t,e,r,s)=>{console.log("amountIn:"+p),console.log("toweiamountIn:"+b(p)),console.log("amountOutMin:"+t),console.log("amountOutMin:"+b(t.toString())),console.log("path:"+e),console.log("to:"+r),console.log("deadline:"+Date.now()+1e3*60*s);try{const c=await o.swapExactTokensForTokens(b(p),b(t.toString()),e,r,Date.now()+6e4*s);return F(c)}catch(c){return R(c),U(c)}},swapExactETHForTokens:async(p,t,e,r,s)=>{try{const c=await o.swapExactETHForTokens(b(t),e,r,Date.now()+6e4*s,{value:le(p.toString())._hex});return F(c)}catch(c){return R(c),U(c)}},swapExactTokensForETH:async(p,t,e,r,s)=>{try{const c=await o.swapExactTokensForTokens(b(p),b(t),e,r,Date.now()+6e4*s);return F(c)}catch(c){return R(c),U(c)}},swapTokensForExactTokens:async(p,t,e,r,s)=>{try{const c=await o.swapTokensForExactTokens(b(p),b(t),e,r,Date.now()+6e4*s);return F(c)}catch(c){return R(c),U(c)}},swapETHForExactTokens:async(p,t,e,r,s)=>{try{const c=await o.swapExactETHForTokens(b(p),e,r,Date.now()+6e4*s,{value:le(t.toString())._hex});return F(c)}catch(c){return R(c),U(c)}},swapTokensForExactETH:async(p,t,e,r,s)=>{console.log(p);try{const c=await o.swapTokensForExactTokens(b(p),b(t),e,r,Date.now()+6e4*s);return F(c)}catch(c){return R(c),U(c)}},addLiquidity:async(p,t,e,r,s,c,B,C)=>{console.log(p,t,e,r,s,c,B,C),console.log(Date.now()+1e3*60*C);try{const K=await(await o.addLiquidity(p,t,b(e),b(r),b(s),b(c),B,Date.now()+6e4*C)).wait();return F(K)}catch(K){return console.log(K),R(K),U(K)}},addLiquidityETH:async(p,t,e,r,s,c,B)=>{try{const C=await(await o.addLiquidityETH(t,b(e),b(r),b(s),c,Date.now()+6e4*B,{value:le(p.toString())._hex})).wait();return F(C)}catch(C){return console.log(C),R(C),U(C)}},removeLiquidity:async(p,t,e,r,s,c,B)=>{console.log(p,t,e,r,s,c,B),console.log(Date.now()+1e3*60*B);try{const C=await(await o.removeLiquidity(p,t,b(e),b(r),b(s),c,Date.now()+6e4*B)).wait();return F(C)}catch(C){return R(C),U(C)}},removeLiquidityETH:async(p,t,e,r,s,c)=>{try{const B=await(await o.removeLiquidityETH(p,b(t),b(e),b(r),s,Date.now()+6e4*c)).wait();return F(B)}catch(B){return R(B),U(B)}}}};const Ye=o=>(fe("data-v-61a5e738"),o=o(),ve(),o),et={class:"text-xs font-medium flex-center-bw"},tt={class:"font-bold text-baseColor text-base"},nt=Ye(()=>a("img",{src:Xe,class:"w-6 h-auto"},null,-1)),ot=[nt],st={class:"bg-box rounded-xl py-1.5 px-2 flex-center h-[62px]"},at={key:1,class:"flex-1"},lt=D({props:{token:{type:null,required:!0},modelValue:{type:[String,Number,null],required:!0},disabled:{type:Boolean,required:!0},loading:{type:Boolean,required:!0}},emits:["update:modelValue","focus","blur","handleSelectToken"],setup(o,{emit:u}){const g=o;Ne(async()=>{A()},3e3,{immediate:!0}),be();const $=X({get:()=>g.modelValue,set:m=>u("update:modelValue",m)}),_=W({symbol:"-",balance:null,price:null}),T=De(m=>{u("update:modelValue",m)},500,{maxWait:5e3}),l=()=>{u("focus"),u("update:modelValue",_.balance)},E=m=>{T(m)},V=async()=>{_.symbol=await L(g.token.address).symbol()},A=async()=>{if(I(g.token.address,S.BNB)){_.balance=await de();return}_.balance=(await L(g.token.address).balanceOf()).toString()},f=async()=>{V(),A()};return ge(g.token,(m,v)=>{f()},{deep:!0,immediate:!0}),(m,v)=>{const p=P("van-icon"),t=P("VanField"),e=P("van-loading");return x(),h("div",null,[a("div",et,[a("div",{class:"px-4 py-3.5 flex-center gap-2 rounded-xl cursor-pointer",onClick:v[1]||(v[1]=ie(r=>u("handleSelectToken"),["stop"]))},[y(ne,{src:o.token.logoURI,class:"w-5 h-5",size:20},null,8,["src"]),a("div",tt,d(o.token.symbol||n(_).symbol),1),y(p,{name:"arrow-down",alt:"",class:"w-3 h-auto text-main"}),a("div",{onClick:v[0]||(v[0]=ie(r=>n(He)(o.token.address),["stop"]))},ot)]),a("div",{class:"text-[#46598B] cursor-pointer text-right",onClick:l},d(m.$t("swap.balance"))+" "+d(n(z)(n(_).balance||0,8)),1)]),a("div",st,[o.loading?(x(),h("div",at,[y(e,{size:"16"})])):(x(),j(t,{key:0,modelValue:n($),"onUpdate:modelValue":[v[2]||(v[2]=r=>G($)?$.value=r:null),E],class:"flex-1 text-xs font-bold bg-box rounded-xl text-baseColor",placeholder:"0",disabled:o.disabled,onFocus:v[3]||(v[3]=r=>u("focus")),onBlur:v[4]||(v[4]=r=>u("blur"))},null,8,["modelValue","disabled"])),Y(` <div class="dark:bg-[#061629] bg-box px-4 py-3.5 flex-center gap-2 rounded-xl cursor-pointer"
        @click.stop="emits('handleSelectToken')">
        <TokenImage :src="token.logoURI" class="w-5 h-5 " :size="20" v-if="logoShow" />
        <div class="font-bold text-baseColor">{{ state.symbol }}</div>
        <van-icon name="arrow-down" alt="" class="w-2.5 h-auto  text-main" />
        <div @click.stop="handleCopy(token.address)"><img src="@/assets/images/copy.svg" class="w-6 h-auto" /></div>
      </div> `)]),Y(` <div class="mt-1 text-xs font-medium flex-center-bw">
      <div></div>
      <div class="text-[#46598B] cursor-pointer text-right" @click="handelMax">{{ $t('swap.balance') }} {{
        formatBalance(state.balance || 0, 8) }}</div>
    </div> `)])}}}),xe=H(lt,[["__scopeId","data-v-61a5e738"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/swap/components/SwapItem.vue"]]),it={key:1},rt=D({props:{token:{type:null,required:!0}},setup(o){const{token:u}=o,g=re(null),$=re(!1),_=async()=>{if(!u.address)return;$.value=!0;const l=I(u.address,S.BNB)?await de():await L(u.address).balanceOf();$.value=!1,g.value=l},T=()=>{_()};return Oe(()=>{T()}),(l,E)=>{const V=P("VanLoading");return x(),h("div",null,[$.value?(x(),j(V,{key:0,size:"14"})):(x(),h("span",it,d(n(z)(g.value||0,4)),1))])}}}),dt=H(rt,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/components/TokenBalance.vue"]]);const ct={class:"bg-white box-shadow rounded-2xl w-[320px] lg:w-[390px] text-black px-2.5 lg:px-5 h-[550px]"},ut={class:"h-[200px] pt-[30px]"},pt={class:"flex-center-bw h-10 font-bold text-2xl"},mt={class:"h-[50px] flex items-center bg-[#EAF4FF] rounded-[15px] mt-[15px] inset-shadow px-1"},wt={class:"grid grid-cols-4 gap-1 py-[15px] border-b border-solid border-[#E9E9E9]"},xt=["onClick"],gt={class:"h-[350px] overflow-y-scroll"},ft={key:0,class:"flex-center mt-4"},vt=["onClick"],bt={class:"flex-center"},yt={class:"flex flex-col ml-2.5"},kt={class:"text-base"},ht={class:"text-[#46598B]"},_t={class:"text-right"},At=D({props:{show:{type:Boolean,required:!0},tokenA:{type:String,required:!1},tokenB:{type:String,required:!1}},emits:["close","confirmSelectToken"],setup(o,{emit:u}){const{show:g,tokenA:$,tokenB:_}=o,T=Me("importTokenList",[]),l=W({tokenAddress:null,tokens:T.value.concat(S.tokens),resultToken:[],searchLoading:!1}),E=async()=>{if(l.resultToken=[],!l.tokenAddress)return;l.searchLoading=!0;const A=S.tokens.filter(m=>m.symbol.includes(l.tokenAddress));if(l.resultToken.push(...A),await L(l.tokenAddress).isErc20()){const m=S.tokens.find(v=>v.address===l.tokenAddress);if(m)l.resultToken.push(m);else{const v={name:await L(l.tokenAddress).name(),symbol:await L(l.tokenAddress).symbol(),address:l.tokenAddress};l.resultToken.push(v)}}l.searchLoading=!1},V=async(A,f)=>{if(f)return;const m={...A,logoURI:A.logoURI||""};l.tokens.findIndex(p=>p.address===A.address)===-1&&T.value.unshift(m),l.tokenAddress=null,u("confirmSelectToken",m),u("close")};return(A,f)=>{const m=P("van-icon"),v=P("van-field"),p=P("VanLoading"),t=P("VanPopup");return o.show?(x(),j(t,{key:0,show:o.show,"onUpdate:show":f[2]||(f[2]=e=>G(g)?g.value=e:null),class:"bg-transparent",rounded:"",onClickOverlay:f[3]||(f[3]=e=>u("close")),onClickCloseIcon:f[4]||(f[4]=e=>u("close"))},{default:N(()=>[a("div",ct,[a("div",ut,[a("div",pt,[a("div",null,d(A.$t("trade.token.select")),1),y(m,{name:"cross",onClick:f[0]||(f[0]=e=>u("close"))})]),a("div",mt,[y(v,{modelValue:n(l).tokenAddress,"onUpdate:modelValue":[f[1]||(f[1]=e=>n(l).tokenAddress=e),E],"right-icon":"search",placeholder:A.$t("trade.token.selectSearch")},{"right-icon":N(()=>[y(m,{name:"search",class:"text-[#29AAC7] text-2xl font-bold",onClick:E})]),_:1},8,["modelValue","placeholder"])]),a("div",wt,[(x(!0),h(te,null,ee(n(l).tokens.slice(0,4),e=>(x(),h("div",{class:se(["bg-[#EAF4FF] rounded-[15px] h-[34px] cursor-pointer flex-center text-sm",{"opacity-60":n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address)}]),onClick:r=>V(e,n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address))},[y(ne,{src:e.logoURI,class:"w-6 h-6 mr-1",size:24},null,8,["src"]),a("span",null,d(e.symbol),1)],10,xt))),256))])]),Y(" scroll "),a("div",gt,[n(l).searchLoading?(x(),h("div",ft,[y(p,{size:"20"})])):(x(!0),h(te,{key:1},ee(n(l).tokenAddress?n(l).resultToken:n(l).tokens,e=>(x(),h("div",{class:se(["h-[45px] flex-center-bw mt-[15px] cursor-pointer",{"opacity-60":n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address)}]),onClick:r=>V(e,n(I)(o.tokenA,e.address)||n(I)(o.tokenB,e.address))},[a("div",bt,[y(ne,{src:e.logoURI,class:"w-6 h-6",size:24},null,8,["src"]),a("div",yt,[a("div",kt,d(e.symbol),1),a("div",ht,d(e.name),1)])]),a("div",_t,[y(dt,{token:e},null,8,["token"])])],10,vt))),256))])])]),_:1},8,["show"])):Y("v-if",!0)}}}),$t=H(At,[["__scopeId","data-v-325f02e4"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/components/SelectTokenPop.vue"]]);const Tt=o=>(fe("data-v-285ec7ff"),o=o(),ve(),o),Lt={class:"bg-white px-4 py-7 w-[320px] text-[#646464]"},Bt={class:"grid grid-cols-4 gap-x-2 mt-4 pb-6 text-[#29AAC7] border-b border-solid border-[#E9E9E9]"},Ct=["onClick"],St={class:"flex-center"},Et=Z(" % "),It={class:"flex-center-bw gap-5 mt-4"},Vt={class:"whitespace-nowrap"},qt={class:"flex-center text-[#29AAC7] gap-1"},Pt=Tt(()=>a("div",null,"mins",-1)),Ft={class:"flex-center-bw mt-5"},Ut={class:"text-[#646464]"},Rt=["src"],Nt=D({props:{show:{type:Boolean,required:!0},slipValue:{type:[String,Number,null],required:!0},timeValue:{type:[String,Number,null],required:!0},modeValue:{type:[Boolean,null],required:!1}},emits:["close","update:slip-value","update:time-value","changeMode"],setup(o,{emit:u}){const{show:g,slipValue:$,modeValue:_}=o,T=[.1,.5,1],l=re(10),E=f=>{u("update:slip-value",+f>=50?50:f)},V=f=>{u("changeMode",!f)},A=()=>{u("close"),u("update:time-value",l.value)};return(f,m)=>{const v=P("VanField"),p=P("VanPopup");return x(),j(p,{show:o.show,"onUpdate:show":m[3]||(m[3]=t=>G(g)?g.value=t:null),class:"bg-transparent",closeable:"",round:"",onClickOverlay:m[4]||(m[4]=t=>u("close")),onClickCloseIcon:A},{default:N(()=>[a("div",Lt,[a("div",null,d(f.$t("swap.slippageTolerance")),1),a("div",Bt,[(x(),h(te,null,ee(T,t=>a("div",{class:"cursor-pointer rounded-xl border border-solid border-[#29AAC7] flex-center",onClick:e=>E(String(t))},d(t)+" % ",9,Ct)),64)),a("div",St,[y(v,{modelValue:o.slipValue,"onUpdate:modelValue":[m[0]||(m[0]=t=>G($)?$.value=t:null),E],"input-align":"center",class:"flex-1 border border-solid border-[#29AAC7] rounded-xl text-xs text-[#29AAC7] font-bold px-0",type:"number"},null,8,["modelValue"]),Et])]),a("div",It,[a("div",Vt,d(f.$t("swap.Txdeadline")),1),a("div",qt,[y(v,{modelValue:l.value,"onUpdate:modelValue":m[1]||(m[1]=t=>l.value=t),class:"flex-1 border border-solid border-[#29AAC7] rounded-xl text-xs text-baseColor font-bold",type:"number","input-align":"center"},null,8,["modelValue"]),Pt])]),a("div",Ft,[a("div",Ut,d(f.$t("swap.expertMode")),1),a("div",{onClick:m[2]||(m[2]=ie(t=>V(o.modeValue),["stop"])),class:"cursor-pointer"},[a("img",{src:n(ze)(`${o.modeValue?"switch-active":"switch"}.svg`),class:"w-16 h-auto"},null,8,Rt)])])])]),_:1},8,["show"])}}}),Ht=H(Nt,[["__scopeId","data-v-285ec7ff"],["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/swap/components/SettingPop.vue"]]),Dt={class:"flex items-center gap-8 p-2.5"},Ot=["onClick"],Mt=D({props:{currentTab:{type:null,required:!0}},emits:["change"],setup(o,{emit:u}){const{t:g}=Ke(),$=X(()=>[{id:0,name:g("liquidity.add")},{id:1,name:g("liquidity.yours")}]);return(_,T)=>(x(),h("div",Dt,[(x(!0),h(te,null,ee(n($),l=>(x(),h("div",{key:l.id,class:se(["cursor-pointer font-semibold rounded-lg py-1",{"text-main":l.id===o.currentTab}]),onClick:E=>u("change",l.id)},d(l.name),11,Ot))),128))]))}}),zt=H(Mt,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/LiquidityTab.vue"]]),Kt=""+new URL("../images/add-da02e148.svg",import.meta.url).href,jt={class:"flex-center gap-x-4 mt-4"},Wt=["onClick"],Zt=D({props:{percentList:{type:Array,required:!0},percent:{type:Number,required:!0}},emits:["change"],setup(o,{emit:u}){return(g,$)=>(x(),h("div",jt,[(x(!0),h(te,null,ee(o.percentList,_=>(x(),h("div",{key:_,onClick:T=>u("change",_),class:se(["py-[3px] px-[18px] rounded-xl border border-solid border-[#081e37] cursor-pointer",{"bg-config-sub text-origin":_===o.percent}])},d(_*100)+"% ",11,Wt))),128))]))}}),Jt=H(Zt,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/PercentBox.vue"]]),Qt={class:"flex-center-bw mb-[38px]"},Xt={class:"text-[32px] font-bold"},Gt=a("img",{src:Ge,class:"w-[27px] h-[27px]",alt:""},null,-1),Yt=[Gt],en=D({emits:["open"],setup(o,{emit:u}){return(g,$)=>(x(),h("div",Qt,[a("div",Xt,[je(g.$slots,"default")]),a("div",{class:"cursor-pointer",onClick:$[0]||($[0]=_=>u("open"))},Yt)]))}}),tn=H(en,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/SettingTitle.vue"]]),nn={class:"bg-white box-shadow rounded-2xl w-[320px] lg:w-[500px] text-black px-5 py-7"},on={class:"flex-center-bw h-10 font-bold text-2xl"},sn={class:"text-[#29AAC7] mt-[15px]"},an={class:"bg-[#E8F0F9] rounded-lg px-5 py-3 mt-[15px]"},ln={class:"flex-center-bw"},rn={class:"flex items-center gap-2.5"},dn={class:"flex items-center"},cn={class:"lg:text-2xl text-sm font-bold"},un={class:"lg:text-2xl text-sm font-bold"},pn={class:"text-right font-bold text-[#29AAC7] lg:text-lg mt-3.5"},mn={class:"flex-center-bw mt-3"},wn={class:"text-[#646464]"},xn={class:"text-right text-[#29AAC7]"},gn={class:"flex-center-bw mt-3"},fn={class:"text-[#646464]"},vn={class:"text-right text-[#29AAC7]"},bn=a("div",{class:"w-full h-[1px] bg-[#E9E9E9] my-[15px]"},null,-1),yn={class:"border border-solid border-config-sub rounded-[10px] p-2.5"},kn={class:"text-config-sub"},hn={class:"text-right mt-3"},_n={class:"text-right"},An=D({props:{show:{type:Boolean,required:!0},pair:{type:null,required:!0},tokenA:{type:null,required:!0},tokenB:{type:null,required:!0},slip:{type:null,required:!0},aPercent:{type:null,required:!0},bPercent:{type:null,required:!0},shares:{type:null,required:!0},expectedLp:{type:null,required:!0}},emits:["close","confirmAdd"],setup(o,{emit:u}){const{show:g,slip:$,shares:_}=o;return(T,l)=>{const E=P("van-icon"),V=P("VanPopup");return x(),j(V,{show:o.show,"onUpdate:show":l[2]||(l[2]=A=>G(g)?g.value=A:null),class:"bg-transparent",rounded:"",onClickOverlay:l[3]||(l[3]=A=>u("close")),onClickCloseIcon:l[4]||(l[4]=A=>u("close"))},{default:N(()=>[a("div",nn,[a("div",on,[a("div",null,d(T.$t("liquidity.confirmAdd")),1),y(E,{name:"cross",onClick:l[0]||(l[0]=A=>u("close"))})]),a("div",sn,d(T.$t("liquidity.willRecieve")),1),a("div",an,[a("div",ln,[a("div",rn,[a("div",dn,[y(ne,{src:o.tokenA.logoURI,class:"-mr-2 w-6 h-6",size:24},null,8,["src"]),y(ne,{src:o.tokenB.logoURI,class:"w-6 h-6",size:24},null,8,["src"])]),a("div",cn,d(o.tokenA.symbol)+"-"+d(o.tokenB.symbol)+" LP",1)]),a("div",un,d(o.pair?n(z)(o.expectedLp,9):""),1)]),a("div",pn,d(n(z)(o.tokenA.amount))+d(o.tokenA.symbol)+"/ "+d(n(z)(o.tokenB.amount))+d(o.tokenB.symbol),1)]),a("div",mn,[a("div",wn,d(T.$t("liquidity.shareInLp")),1),a("div",xn,d(o.pair?n(z)(o.shares,9):"100")+" %",1)]),a("div",gn,[a("div",fn,d(T.$t("trade.token.slippageLimit")),1),a("div",vn,d(o.slip)+"%",1)]),bn,a("div",yn,[a("div",kn,d(T.$t("trade.token.rate")),1),a("div",hn," 1 "+d(o.tokenA.symbol)+" = "+d(o.pair?n(z)(new n(k)(o.aPercent).div(o.bPercent).toString(),9):new n(k)(o.tokenA.amount).dividedBy(o.tokenB.amount).toString())+" "+d(o.tokenB.symbol),1),a("div",_n," 1 "+d(o.tokenB.symbol)+" = "+d(o.pair?n(z)(new n(k)(o.bPercent).div(o.aPercent).toString(),9):new n(k)(o.tokenB.amount).dividedBy(o.tokenA.amount).toString())+" "+d(o.tokenA.symbol),1)]),y(Q,{class:"mt-[15px]",loading:!1,disabled:!1,onClick:l[1]||(l[1]=A=>u("confirmAdd"))},{default:N(()=>[Z(d(T.$t("liquidity.confirmAdd")),1)]),_:1})])]),_:1},8,["show"])}}}),$n=H(An,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/ConfirmAddPop.vue"]]),Tn={class:"lg:px-8 px-2.5 py-5"},Ln=a("div",{class:"py-8 flex-center"},[a("img",{src:Kt,class:"w-6 h-6",alt:""})],-1),Bn={key:1,class:"grid grid-cols-2 gap-1 mt-7"},Cn={key:0},Sn={key:1},En={key:2},In={key:3},Vn=D({setup(o){const[u,g]=J(!1),[$,_]=J(!1),[T,l]=J(!1),{getPair:E}=We(),{addLiquidity:V,addLiquidityETH:A}=be(),{getCurrentAccount:f}=Ze(),m=X(()=>t.allowance>=+t.amount&&t.allowance>0),v=X(()=>e.allowance>=+e.amount&&e.allowance>0),p=[.25,.5,.75,1],t=W({...S.tokens[0],balance:0,allowance:0,decimals:18,amount:null,percent:0}),e=W({...S.tokens[1],balance:0,allowance:0,decimals:18,amount:null,percent:0}),r=W({slip:.1,time:10,min:"0",mode:!1}),s=W({settingShow:!1,btnLoading:!1,havePair:!1,aPercent:"0",bPercent:"0",aDisabled:!1,bDisabled:!1,aInputLoading:!1,bInputLoading:!1,pair:null,txInfo:{tx:null,text:""},tokenSelectIndex:0,shares:"0",totalSupply:"0",aInLpAmount:"0",bInLpAmount:"0"}),c=X(()=>{if(s.pair){const i=new k(t.amount).multipliedBy(s.totalSupply).div(s.aInLpAmount).toFixed(),w=new k(e.amount).multipliedBy(s.totalSupply).div(s.bInLpAmount).toFixed();return Math.min(+i,+w)}else return new k(t.amount).multipliedBy(e.amount).minus(1e3)}),B=i=>{t.amount=null,e.amount=null,s.tokenSelectIndex=i,_(!0)},C=i=>{s.btnLoading||(t.percent=i,ce(new k(t.balance).multipliedBy(i).toString()),s.havePair&&(e.percent=0))},K=i=>{r.slip=i},ye=i=>{r.time=i},ke=i=>{r.mode=i},he=()=>{s.bDisabled=!0,s.aDisabled=!1},_e=()=>{s.aDisabled=!0,s.bDisabled=!1},ce=async i=>{if(t.amount=i,!!s.havePair){if(i===""){t.amount=null,e.amount=null,s.bInputLoading=!1;return}s.bInputLoading=!0,e.amount=new k(t.amount).times(new k(s.bPercent)).dividedBy(new k(s.aPercent)).toFixed(),s.bInputLoading=!1}},Ae=async i=>{if(e.amount=i,!!s.havePair){if(i===""){t.amount=null,e.amount=null,s.aInputLoading=!1;return}s.aInputLoading=!0,t.amount=new k(e.amount).times(new k(s.aPercent)).dividedBy(new k(s.bPercent)).toFixed(),s.aInputLoading=!1}},$e=async()=>{s.btnLoading=!0,m.value?await L(e.address).approve(S.PANCAKE_ROUTER):await L(t.address).approve(S.PANCAKE_ROUTER),await oe(),s.btnLoading=!1},[Te,ue]=J(!1),Le=async()=>{ue(!0),await L(t.address).approve(S.PANCAKE_ROUTER),await oe(),ue(!1)},[Be,pe]=J(!1),Ce=async()=>{pe(!0),await L(e.address).approve(S.PANCAKE_ROUTER),await oe(),pe(!1)},Se=async()=>{if(!m.value||!v.value)return $e();g(!0)},Ee=async()=>{g(!1),s.btnLoading=!0;let i;const w=I(t.address,S.BNB),q=I(e.address,S.BNB);if(t.amountTokenMin=new k(t.amount).times(1e4-100*r.slip).div(1e4).toFixed(t.decimals||18),e.amountTokenMin=new k(e.amount).times(1e4-100*r.slip).div(1e4).toFixed(e.decimals||18),w||q){const O=w?t:e,M=w?e:t;console.log(O),console.log(M),i=await A(new k(O.amount).toFixed(O.decimals),M.address,new k(M.amount).toFixed(M.decimals),M.amountTokenMin,O.amountTokenMin,f(),r.time)}else i=await V(t.address,e.address,new k(t.amount).toFixed(t.decimals),new k(e.amount).toFixed(e.decimals),t.amountTokenMin,e.amountTokenMin,f(),r.time);if(s.btnLoading=!1,!i.success)return g(!0);await ae()},me=async i=>{const{balanceOf:w,allowance:q,symbol:O,decimals:M}=L(i),qe=I(i,S.BNB)?await de():await w(),Pe=I(i,S.BNB)?Je:await q(S.PANCAKE_ROUTER),Fe=await O(),Ue=await M();return{balance:qe,allowance:+Pe,symbol:Fe,decimals:Ue}},oe=async()=>{const i=await me(t.address),w=await me(e.address);t.balance=i.balance,t.allowance=i.allowance,t.symbol=i.symbol,t.decimals=i.decimals,e.balance=w.balance,e.allowance=w.allowance,e.symbol=w.symbol,e.decimals=w.decimals},Ie=async()=>{const i=await E(t.address,e.address);if(s.pair=i,i===Qe)return s.pair=null,!1;const w=await L(t.address).balanceOf(s.pair),q=await L(e.address).balanceOf(s.pair),O=new k(w).plus(new k(q));s.aPercent=new k(w).dividedBy(O).multipliedBy(100).toString(),s.bPercent=new k(q).dividedBy(O).multipliedBy(100).toString();const M=await L(i).balanceOf();return s.totalSupply=await L(i).totalSupply(),s.shares=new k(M).div(s.totalSupply).multipliedBy(100).toFixed(),s.aInLpAmount=String(await L(t.address).balanceOf(i)),s.bInLpAmount=String(await L(e.address).balanceOf(i)),!0},Ve=i=>{if(s.tokenSelectIndex===0)for(let w in i)t[w]=i[w];else for(let w in i)e[w]=i[w];ae()},ae=async()=>{s.btnLoading=!0,await oe(),s.havePair=await Ie(),s.btnLoading=!1};return ge(()=>[t,e],async()=>{ae()},{immediate:!0}),(i,w)=>(x(),h("div",Tn,[y(tn,{onOpen:w[0]||(w[0]=q=>n(l)(!0))},{default:N(()=>[Z(d(i.$t("liquidity.add")),1)]),_:1}),y(xe,{token:n(t),modelValue:n(t).amount,"onUpdate:modelValue":ce,onFocus:he,disabled:n(s).btnLoading,onHandleSelectToken:w[1]||(w[1]=q=>B(0)),loading:n(s).aInputLoading},null,8,["token","modelValue","disabled","loading"]),y(Jt,{percentList:p,onChange:C,percent:n(t).percent},null,8,["percent"]),Ln,y(xe,{token:n(e),modelValue:n(e).amount,"onUpdate:modelValue":Ae,onFocus:_e,disabled:n(s).btnLoading,loading:n(s).bInputLoading,onHandleSelectToken:w[2]||(w[2]=q=>B(1))},null,8,["token","modelValue","disabled","loading"]),Y(' <PercentBox :percentList="percentList" @change="changeAmountB" :percent="tokenB.percent" /> '),+n(t).amount>+n(t).balance||n(t).balance<=0||+n(e).amount>+n(e).balance||+n(e).balance<=0?(x(),j(Q,{key:0,class:"mt-7",disabled:""},{default:N(()=>[Z(d(i.$t("errorMsg.InsufficientBalance")),1)]),_:1})):!n(m)||!n(v)?(x(),h("div",Bn,[y(Q,{loading:n(Te),disabled:n(m),onClick:Le},{default:N(()=>[Z(" Approve "+d(n(t).symbol),1)]),_:1},8,["loading","disabled"]),y(Q,{loading:n(Be),disabled:n(v),onClick:Ce},{default:N(()=>[Z(" Approve "+d(n(e).symbol),1)]),_:1},8,["loading","disabled"])])):(x(),j(Q,{key:2,class:"mt-7",loading:n(s).btnLoading,onClick:Se,disabled:+n(t).amount<=0||+n(e).amount<=0},{default:N(()=>[+n(t).amount>+n(t).balance||n(t).balance<=0?(x(),h("span",Cn,d(i.$t("errorMsg.InsufficientBalance")),1)):n(m)?n(v)?(x(),h("span",In,d(i.$t("trade.addLiquid")),1)):(x(),h("span",En,"Approve "+d(n(e).symbol),1)):(x(),h("span",Sn,"Approve "+d(n(t).symbol),1))]),_:1},8,["loading","disabled"])),y($t,{tokenA:n(t).address,tokenB:n(e).address,show:n($),onClose:w[3]||(w[3]=q=>n(_)(!1)),onConfirmSelectToken:Ve},null,8,["tokenA","tokenB","show"]),y(Ht,{show:n(T),onClose:w[4]||(w[4]=q=>n(l)(!1)),timeValue:n(r).time,slipValue:n(r).slip,modeValue:n(r).mode,"onUpdate:slipValue":K,"onUpdate:timeValue":ye,onChangeMode:ke},null,8,["show","timeValue","slipValue","modeValue"]),y($n,{pair:n(s).pair,show:n(u),onClose:w[5]||(w[5]=q=>n(g)(!1)),onConfirmAdd:Ee,removeAmount:0,tokenA:n(t),tokenB:n(e),slip:n(r).slip,aPercent:n(s).aPercent,bPercent:n(s).bPercent,shares:n(s).shares,expectedLp:n(c)},null,8,["pair","show","tokenA","tokenB","slip","aPercent","bPercent","shares","expectedLp"])]))}}),qn=H(Vn,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/components/Add.vue"]]),Pn={class:"max-w-[600px] relative"},Fn=D({setup(o){return(u,g)=>(x(),h("div",Pn,[y(zt,{"current-tab":1}),y(qn)]))}}),Un=H(Fn,[["__file","/Users/wangkeai/work/xueyan/followx/followx-dapp/src/view/liquidity/RemoveLiquidity.vue"]]),Dn=Object.freeze(Object.defineProperty({__proto__:null,default:Un},Symbol.toStringTag,{value:"Module"}));export{zt as L,Jt as P,qn as R,xe as S,Ge as _,Ht as a,$t as b,Kt as c,tn as d,Un as e,Dn as f,be as r};
